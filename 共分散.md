# 公式

## 期待値

```
E[X+Y] = E[X] + E[Y]
E[X-Y] = E[X] - E[Y]
```

XとYが独立である場合に以下の式が成り立つ

```
E[XY] = E[X] * E[Y]
```

## 分散

```
V[X+Y] = V[X] + V[Y] + 2Cov[X,Y]
V[X-Y] = V[X] + V[Y] - 2Cov[X,Y]
```

Cov[X,Y]

=> 共分散 Covariance

共分散が0（=XとYが独立である）場合に以下の式が成り立つ

```
V[X+Y] = V[X] + V[Y]
V[X-Y] = V[X] + V[Y]
```

## 共分散

確率変数X,　Yの期待値をそれぞれ `E[X] = μ_x`, `E[Y] = μ_y` とする

XとYに正の相関がある場合は `Cov[X, Y] > 0`, 負の相関がある場合は `Cov[X, Y] < 0` になる

### 公式1

```
Cov[X, Y]
= E[(X - μ_x)(Y - μ_y)]

上の式を展開すると
= E[XY] - (μ_x * μ_y)
```

### 公式2

分散の公式から

```
V[X+Y] = V[X] + V[Y] + 2Cov[X,Y]
2Cov[X,Y] = V[X+Y] - V[X] - V[Y]
Cov[X,Y] = (V[X+Y] - V[X] - V[Y]) / 2
```

## 相関係数

2変数間の直線的関係の強さを表す統計量

確率変数XとYの相関係数

```
p = Cov[X, Y] / √(V[X] * V[Y])
```

# 例

## 期待値

2つのさいころの出る目X, Yの和の期待値E[X + Y]は

```
E[X + Y] = 3.5 + 3.5 = 7
```

## 共分散

A～Cさんのテストの点数から

1. 合計の期待値
1. 合計の分散
1. 国語と数学の相関係数を求める

||Aさん|Bさん|Cさん|
|---|---|---|---|
|国語 X|40|50|60|
|数学 Y|70|50|90|
|合計 X|110|100|150|

```
E[X] = (40 + 50 + 60) / 3 = 50
E[Y] = (70 + 50 + 90) / 3 = 70
E[X+Y] = 50 + 70 = 120
```

```
V[X]
= ((40 - 50)^2 + (50 - 50)^2 + (60 - 50)^2) / 3
= (100 + 100) / 3
= 200 / 3

V[Y]
= ((70 - 70)^2 + (50 - 70)^2 + (90 - 70)^2) / 3
= (400 + 400) / 3
= 800 / 3

V[X+Y]
= ((110 - 120)^2 + (100 - 120)^2 + (150 - 120)^2) / 3
= (100 + 400 + 900) / 3
= 1400 / 3
```

共分散の公式2より

```
Cov[X, Y]
= ((1400 / 3) - (200 / 3) - (800 / 3)) / 2
= (400 / 3) / 2
= (400 / 3) * (1 / 2)
= 200 / 3
```

```
p
= (200 / 3) / √((200 / 3) * (800 / 3))
= (200 / 3) / 133.333333333
= 0.5
```

---

参考

[15-6. 2変数の期待値と分散 | 統計学の時間 | 統計WEB](https://bellcurve.jp/statistics/course/18592.html)
