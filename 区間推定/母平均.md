# 概要

母集団が正規分布だとわかっている場合の母平均の区間推定の方法は以下の2つ

1. 正規分布を用いた推定（母分散が既知）
1. t分布を用いた推定（母分散が未知）

## 正規分布を用いた推定

**母分散** の値が分かっていれば標本平均の実現値から母平均の値を推定できる

現実には母平均の値が不明の場合は母分散の値も分からないのが普通

※母分散を標本の不偏分散で代用する方法もあるがサンプルサイズが十分大きい必要がある

不偏分散で代用する場合のサンプルサイズの基準は `n > 100`

## t分布を用いた推定

t分布は「母分散が未知の値でありn = 20個程度のデータしか集められない場合に、母平均の値を推定したい」ときに利用される確率分布

# 例

## 正規分布を用いた推定

A工場で作られるネジの重さは母分散 `σ^2 = 4` に従う

母平均μの値を知りたい

試しに16個のネジを作ったら標本平均の実現値は `xバー = 7` だった

したがって母平均を推定するための統計値zは

```
// 標本平均を標準化している
z = (xバー - μ) / √(σ^2 / n)
= (7 - μ) / √(4 / 16)
= (7 - μ) / 0.5
= 14 - 2μ
```

95%信頼区間で推定する場合は `- 1.96 ≤ 14 - 2μ ≤ 1.96` なので

この式を展開すると

```
- 1.96 ≤ 14 - 2μ ≤ 1.96

// 14を引く
- 15.96 ≤ - 2μ ≤ - 12.04

// -2で割る
// マイナスの値で割るので不等号が逆転する
7.98 ≥ μ ≥ 6.02
```

## t分布を用いた推定

ある工場では生産している部品Aを1時間毎にランダムに1つ抜き取りその重さを検査している

計10個の部品Aの重さを測定した結果、次のようなデータが得られた

ただし、母分散は未知で部品Aの重さは正規分布に従うものとする

|No|部品Aの重さg|
|---|---|
|1|100.2|
|2|101.5|
|3|98.0|
|4|100.1|
|5|100.9|
|6|99.6|
|7|98.6|
|8|102.1|
|9|101.4|
|10|97.9|

```py
from statistics import mean, variance

weight = [100.2, 101.5, 98.0, 100.1, 100.9, 99.6, 98.6, 102.1, 101.4, 97.9]

# 平均 xバー
print(mean(price))

# 不偏分散 s^2
print(variance(price))
```

結果

```
100.03
2.2223333333333333
```

母平均を推定するための統計値tは

```
t = (xバー - μ) / √(s^2 / n)
```

t分布表において上側2.5%点は「2.262」なので

統計量tの範囲は

```
- 2.262 ≤ (xバー - μ) / √(s^2 / n) ≤ 2.262
```

この式を変形すると

```
// √(s^2 / n)をかける
- 2.262 * √(s^2 / n) ≤ (xバー - μ) ≤ 2.262 * √(s^2 / n)

// xバーを引く
-xバー - 2.262 * √(s^2 / n) ≤ - μ ≤ - xバー + 2.262 * √(s^2 / n)

// -1をかける
// マイナスの値をかけるので不等号が逆転する
xバー + 2.262 * √(s^2 / n) ≥ μ ≥ xバー - 2.262 * √(s^2 / n)
```

この式に標本平均と不偏分散を代入すると

```
xバー - 2.262 * √(s^2 / n) ≤ μ ≤ xバー + 2.262 * √(s^2 / n)

100.03 - 2.262 * √(2.22 / 10) ≤ μ ≤ 100.03 + 2.262 * √(2.22 / 10)

100.03 - 1.06578373416 ≤ μ ≤ 100.03 + 1.06578373416

‭98.96421626584 ≤ μ ≤ 101.09578373416‬
```

母平均は100回に95回の割合で `‭98.96 ≤ μ ≤ 101.09` の範囲に含まれる

---

参考

[t分布とは何か。小標本における母平均の95％信頼区間の計算法とその解釈｜アタリマエ！](https://atarimae.biz/archives/14046)

[20-3. 母平均の信頼区間の求め方（母分散未知） | 統計学の時間 | 統計WEB](https://bellcurve.jp/statistics/course/8972.html)
