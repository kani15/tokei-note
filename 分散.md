# 概要

分散とは **データのばらつきの大きさ** を表わす指標

英単語はvariance

## 記号

`σ^2` は母集団の分散

`s^2` は標本の分散

`V[X]` は確率変数Xの分散

確率変数 = 確率によって値が変わる数のこと

例. サイコロの出目

## 分散の利点

TODO

# 公式

V[X] = E[(X - E[X])^2]

E[X] = Xの期待値 = μ 母平均

**平均との差を2乗した値の期待値** を分散と呼ぶ

# 例

## 標本の分散

英語と数学のテストの点数が以下のようになっていた場合

```py
from statistics import mean

# https://docs.python.org/ja/3/library/functools.html#functools.reduce
from functools import reduce

def get_variance(score):
    # 平均
    m = mean(score)
    # 長さ
    l = len(score)

    # 偏差の2乗の合計をデータの総数で割る
    return reduce(lambda a, b: a + pow(b - m, 2), score, 0) / l

score_english = [80, 45, 75, 60, 90]
print(get_variance(score_english))

score_math = [40, 90, 30, 75, 65]
print(get_variance(score_math))
```

結果

```
250.0
490.0
```

英語の点数の分散は250

数学の点数の分散は490

英語に比べると数学の方が点数のばらつきが大きいと判断できる。

## 離散型確率変数Xの分散

さいころを投げて出る目を確率変数Xとする

ただしE[X] = 3.5である

| さいころの出る目 X | 確率 P(X) |
| --- | --- |
| 1 | 1/6 |
| 2 | 1/6 |
| 3 | 1/6 |
| 4 | 1/6 |
| 5 | 1/6 |
| 6 | 1/6 |

```
V[X]
= Σ_{i=1}^n * (x_i - μ)^2 * p_i
= Σ_{i=1}^n * (x_i - 3.5)^2 * p_i
= (1 - 3.5)^2 / 6 + (2 - 3.5)^2 / 6 + (3 - 3.5)^2 / 6 + (4 - 3.5)^2 / 6 + (5 - 3.5)^2 / 6 + (6 - 3.5)^2 / 6
= 1/6 * (6.25 + 2.25 + 0.25 + 0.25 + 2.25 + 6.25)
= 17.5/6
= 35/12
```

## 連続型確率変数Xの分散

確率密度関数 `f(x) = 1/6` において確率変数が0から6の範囲をとる

ただしE[X] = 3である

```
V[X]
= ∫_0^6 * (x - μ)^2 * f(x) * dx
= ∫_0^6 * (x - 3)^2 * 1/6 * dx
= [(x - 3)^3/3 * 1/6]_0^6
= [(x - 3)^3/18]_0^6
= 27/18 - (-27/18)
= 54/18
= 3
```

## 離散型確率変数Xの分散を期待値から求める

| さいころの出る目 X | X^2 | 確率 P(X) |
| --- | --- | --- |
| 1 | 1 | 1/6 |
| 2 | 4 | 1/6 |
| 3 | 9 | 1/6 |
| 4 | 16 | 1/6 |
| 5 | 25 | 1/6 |
| 6 | 36 | 1/6 |

```
V[X] = E[X^2] - {E[X]}^2

E[X^2]
= 1/6 * (1^2 + 2^2 + 3^2 + 4^2 + 5^2 + 6^2)
= 1/6 * (1 + 4 + 9 + 16 + 25 + 36)
= 91/6

{E[X]}^2
= (3.5)^2
= (7/2)^2
= 49/4

V[X]
= 91/6 - 49/4
= 182/12 - 147/12
= 35/12
```

---

参考

[分散の求め方と公式。その有用性について｜アタリマエ！](https://atarimae.biz/archives/8782)

[12-5. 確率変数の分散 | 統計学の時間 | 統計WEB](https://bellcurve.jp/statistics/course/6716.html)
